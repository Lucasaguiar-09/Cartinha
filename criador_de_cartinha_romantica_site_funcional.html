<index.html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cartinha Rom√¢ntica üíñ</title>
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: linear-gradient(135deg, #ff9a9e, #fad0c4);
      margin: 0;
      padding: 20px;
      overflow-x: hidden;
    }

    h1, h2 { text-align: center; color: #b3124a; }

    .container {
      max-width: 1000px;
      margin: auto;
      background: white;
      border-radius: 20px;
      padding: 25px;
      box-shadow: 0 15px 40px rgba(0,0,0,0.2);
      animation: fadeIn 1s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .hidden { display: none; }

    button {
      padding: 12px 18px;
      border: none;
      border-radius: 12px;
      background: #e91e63;
      color: white;
      font-size: 1rem;
      cursor: pointer;
      margin-top: 10px;
    }

    button:hover { background: #c2185b; }

    input, textarea {
      width: 100%;
      padding: 10px;
      margin-top: 6px;
      border-radius: 8px;
      border: 1px solid #ccc;
    }

    .tabs { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
    .tab { flex: 1; background: #eee; padding: 10px; border-radius: 10px; cursor: pointer; text-align: center; font-weight: bold; }
    .tab.active { background: #e91e63; color: white; }

    .section { display: none; }
    .section.active { display: block; }

    .fotos { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; margin-top: 15px; }
    .foto-item { position: relative; cursor: grab; }
    .foto-item img { width: 100%; border-radius: 12px; }

    .remove-btn {
      position: absolute;
      top: 5px; right: 5px;
      background: red;
      color: white;
      border: none;
      border-radius: 50%;
      width: 26px;
      height: 26px;
      cursor: pointer;
    }

    .capa {
      border: 4px solid #e91e63;
    }

    .tempo { font-weight: bold; margin: 15px 0; }

    iframe { border-radius: 12px; margin-top: 15px; }

    /* cora√ß√µes */
    .heart {
      position: fixed;
      bottom: -20px;
      color: #ff4d6d;
      font-size: 20px;
      animation: subir 6s linear forwards;
      opacity: 0.8;
    }

    @keyframes subir {
      from { transform: translateY(0); opacity: 1; }
      to { transform: translateY(-110vh); opacity: 0; }
    }

    /* tela senha */
    #senhaTela {
      position: fixed;
      inset: 0;
      background: linear-gradient(135deg, #ff9a9e, #fad0c4);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }

    .senhaBox {
      background: white;
      padding: 30px;
      border-radius: 20px;
      text-align: center;
      max-width: 350px;
      width: 100%;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    }

    /* modo surpresa */
    #surpresa {
      text-align: center;
      padding: 80px 20px;
    }
  </style>
</head>
<body>

<!-- TELA DE SENHA -->
<div id="senhaTela">
  <div class="senhaBox">
    <h2>üíå √Årea secreta</h2>
    <p>Digite a senha para entrar</p>
    <input type="password" id="senhaInput" placeholder="Senha" />
    <button onclick="verificarSenha()">Entrar</button>
  </div>
</div>

<div class="container hidden" id="app">

  <h1>üíñ Criador de Cartinha</h1>

  <div class="tabs">
    <div class="tab active" onclick="abrirAba(0)">Conte√∫do</div>
    <div class="tab" onclick="abrirAba(1)">Fotos</div>
    <div class="tab" onclick="abrirAba(2)">M√∫sica</div>
    <div class="tab" onclick="abrirAba(3)">Visualizar</div>
  </div>

  <!-- CONTE√öDO -->
  <div class="section active">
    <label>T√≠tulo</label>
    <input id="titulo" placeholder="Para meu amor ‚ù§Ô∏è" />

    <label>Data e hora do pedido</label>
    <input type="datetime-local" id="dataInicio" />

    <label>Texto</label>
    <textarea id="texto" rows="6"></textarea>

    <button onclick="salvarDados()">üíæ Salvar</button>
  </div>

  <!-- FOTOS -->
  <div class="section">
    <label>Selecionar fotos</label>
    <input type="file" id="fotosArquivos" multiple accept="image/*" />
    <p>Arraste para ordenar ‚Ä¢ Primeira vira capa</p>

    <div id="previewFotos" class="fotos"></div>
  </div>

  <!-- MUSICA -->
  <div class="section">
    <label>Link do YouTube</label>
    <input id="linkMusica" placeholder="https://youtube.com/..." />
    <button onclick="salvarDados()">Salvar m√∫sica</button>
  </div>

  <!-- VISUALIZA√á√ÉO -->
  <div class="section">
    <div id="surpresa">
      <h2>üéÅ Clique para revelar a surpresa</h2>
      <button onclick="mostrarCartinha()">Abrir üíñ</button>
    </div>

    <div id="preview" class="hidden"></div>
  </div>

</div>

<script>
/* ================= SENHA ================= */
const SENHA = '2304';

function verificarSenha() {
  const v = document.getElementById('senhaInput').value;
  if (v === SENHA) {
    document.getElementById('senhaTela').style.display = 'none';
    document.getElementById('app').classList.remove('hidden');
  } else alert('Senha incorreta');
}

/* ================= ABAS ================= */
function abrirAba(i) {
  document.querySelectorAll('.tab').forEach((t,idx)=>t.classList.toggle('active', idx===i));
  document.querySelectorAll('.section').forEach((s,idx)=>s.classList.toggle('active', idx===i));
  if(i===3) gerarPreview();
}

/* ================= FOTOS ================= */
let fotos = [];

const inputFotos = document.getElementById('fotosArquivos');
inputFotos.addEventListener('change', () => {
  [...inputFotos.files].forEach(file => {
    const reader = new FileReader();
    reader.onload = e => {
      fotos.push(e.target.result);
      salvarFotos();
      renderFotos();
    };
    reader.readAsDataURL(file);
  });
});

function renderFotos() {
  const area = document.getElementById('previewFotos');
  area.innerHTML = '';

  fotos.forEach((f, i) => {
    const div = document.createElement('div');
    div.className = 'foto-item' + (i === 0 ? ' capa' : '');
    div.draggable = true;

    div.innerHTML = `
      <img src="${f}">
      <button class="remove-btn" onclick="removerFoto(${i})">√ó</button>
    `;

    div.ondragstart = e => e.dataTransfer.setData('i', i);
    div.ondragover = e => e.preventDefault();
    div.ondrop = e => {
      const de = e.dataTransfer.getData('i');
      const temp = fotos[de];
      fotos[de] = fotos[i];
      fotos[i] = temp;
      salvarFotos();
      renderFotos();
    };

    area.appendChild(div);
  });
}

function removerFoto(i) {
  fotos.splice(i,1);
  salvarFotos();
  renderFotos();
}

function salvarFotos() {
  localStorage.setItem('fotosBase64', JSON.stringify(fotos));
}

/* ================= DADOS ================= */
function salvarDados() {
  localStorage.setItem('cartinha', JSON.stringify({
    titulo: titulo.value,
    data: dataInicio.value,
    texto: texto.value,
    musica: linkMusica.value
  }));
  alert('Salvo ‚ù§Ô∏è');
}

function carregar() {
  const d = JSON.parse(localStorage.getItem('cartinha') || '{}');
  titulo.value = d.titulo || '';
  dataInicio.value = d.data || '';
  texto.value = d.texto || '';
  linkMusica.value = d.musica || '';

  fotos = JSON.parse(localStorage.getItem('fotosBase64') || '[]');
  renderFotos();
}

/* ================= PREVIEW FINAL ================= */
let intervalo;

function mostrarCartinha() {
  document.getElementById('surpresa').style.display = 'none';
  document.getElementById('preview').classList.remove('hidden');
  gerarPreview();
}

function gerarPreview() {
  const dados = JSON.parse(localStorage.getItem('cartinha')) || {};

  let musicaHTML = '';
  if (dados.musica) {
    let link = dados.musica;
    if (link.includes('watch?v=')) link = link.replace('watch?v=', 'embed/');
    musicaHTML = `<iframe width="100%" height="315" src="${link}" allowfullscreen></iframe>`;
  }

  document.getElementById('preview').innerHTML = `
    <div class="cartinha">
      <h2>${dados.titulo || ''}</h2>
      <div class="tempo" id="tempo"></div>
      <p>${(dados.texto || '').replace(/\n/g,'<br>')}</p>

      <div class="fotos">
        ${fotos.map(f=>`<img src="${f}">`).join('')}
      </div>

      ${musicaHTML}
    </div>
  `;

  if (intervalo) clearInterval(intervalo);

  if (dados.data) {
    const inicio = new Date(dados.data);
    intervalo = setInterval(()=>{
      const agora = new Date();
      const diff = agora - inicio;
      const d = Math.floor(diff/86400000);
      const h = Math.floor(diff/3600000)%24;
      const m = Math.floor(diff/60000)%60;
      const s = Math.floor(diff/1000)%60;
      const el = document.getElementById('tempo');
      if(el) el.innerText = `Estamos juntos h√° ${d} dias, ${h}h ${m}m ${s}s ‚ù§Ô∏è`;
    },1000);
  }
}

/* cora√ß√µes */
setInterval(()=>{
  const h = document.createElement('div');
  h.className = 'heart';
  h.innerText = '‚ù§';
  h.style.left = Math.random()*100 + 'vw';
  h.style.fontSize = (14 + Math.random()*20) + 'px';
  document.body.appendChild(h);
  setTimeout(()=>h.remove(),6000);
}, 800);

carregar();
</script>
</body>
</html>
