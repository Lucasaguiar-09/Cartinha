<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cartinha Especial ğŸ’–</title>

<style>
:root{
  --rosa:#ff4d88;
  --vermelho:#c2185b;
  --preto:#0f0f14;
}

*{box-sizing:border-box;}

body{
  margin:0;
  font-family:"Segoe UI",sans-serif;
  background:linear-gradient(135deg,#0f0f14,#2a0015,#ff4d88);
  color:white;
  overflow-x:hidden;
}

.tela{
  display:none;
  min-height:100vh;
  padding:25px;
  animation:fade .6s ease;
}

.tela.ativa{display:block;}

@keyframes fade{
  from{opacity:0;transform:translateY(20px)}
  to{opacity:1;transform:translateY(0)}
}

.caixa{
  max-width:700px;
  margin:auto;
  background:rgba(0,0,0,.6);
  border-radius:25px;
  padding:30px;
  box-shadow:0 0 40px rgba(255,77,136,.4);
  text-align:center;
}

h1,h2{
  color:#ff7aa8;
}

button{
  background:linear-gradient(135deg,#ff4d88,#c2185b);
  color:white;
  border:none;
  padding:14px 24px;
  border-radius:18px;
  font-size:16px;
  margin:10px;
  cursor:pointer;
  transition:.3s;
}

button:hover{transform:scale(1.05);}

.voltar{background:#444;}

input,textarea{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:none;
  margin-top:10px;
  font-size:16px;
}

textarea{resize:none;min-height:120px;}

.fotos{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(120px,1fr));
  gap:10px;
  margin-top:15px;
}

.fotos img{
  width:100%;
  border-radius:14px;
}

.tempo{
  font-size:20px;
  margin-top:15px;
  font-weight:bold;
}

.heart{
  position:fixed;
  bottom:-20px;
  color:#ff4d88;
  animation:subir 6s linear forwards;
}

@keyframes subir{
  from{transform:translateY(0);opacity:1}
  to{transform:translateY(-120vh);opacity:0}
}

/* QR */
#qr img{margin-top:15px;border-radius:12px;background:white;padding:10px}

</style>
</head>
<body>

<!-- TELA SENHA -->
<section class="tela ativa" id="senhaTela">
  <div class="caixa">
    <h1>ğŸ” Ãrea Especial</h1>
    <p>Crie uma senha para proteger essa cartinha</p>
    <input id="senhaCriada" type="password" placeholder="Criar senha">
    <button onclick="definirSenha()">Continuar ğŸ’–</button>
  </div>
</section>

<!-- MENU -->
<section class="tela" id="menu">
  <div class="caixa">
    <h1>ğŸ’Œ Sua Cartinha</h1>
    <p>Escolha o que deseja fazer</p>

    <button onclick="ir('editor')">âœï¸ Criar / Editar</button>
    <button onclick="ir('preview')">ğŸ‘€ Ver como ficou</button>
    <button onclick="ir('link')">ğŸ”— Link / QR Code</button>
  </div>
</section>

<!-- EDITOR -->
<section class="tela" id="editor">
  <div class="caixa">
    <h2>âœï¸ ConteÃºdo</h2>

    <label>TÃ­tulo</label>
    <input id="titulo" placeholder="Para o amor da minha vida ğŸ’•">

    <label>Data do inÃ­cio</label>
    <input type="datetime-local" id="dataInicio">

    <label>Texto da cartinha</label>
    <textarea id="texto"></textarea>

    <label>Fotos</label>
    <input type="file" multiple accept="image/*" id="fotosInput">

    <label>MÃºsica (MP3)</label>
    <input type="file" accept="audio/*" id="musicaInput">

    <button onclick="salvarTudo()">ğŸ’¾ Salvar</button>
    <button class="voltar" onclick="ir('menu')">â¬… Voltar</button>
  </div>
</section>

<!-- PREVIEW -->
<section class="tela" id="preview">
  <div class="caixa">
    <h1 id="pTitulo"></h1>
    <div class="tempo" id="tempo"></div>
    <p id="pTexto"></p>

    <div class="fotos" id="pFotos"></div>

    <audio id="audio" controls loop></audio>

    <br>
    <button class="voltar" onclick="ir('menu')">â¬… Voltar</button>
  </div>
</section>

<!-- LINK / QR -->
<section class="tela" id="link">
  <div class="caixa">
    <h2>ğŸ”— Compartilhar</h2>
    <p>Envie este link para ela:</p>
    <input id="linkFinal" readonly>

    <div id="qr"></div>

    <button onclick="copiarLink()">ğŸ“‹ Copiar link</button>
    <button class="voltar" onclick="ir('menu')">â¬… Voltar</button>
  </div>
</section>

<script>
// navegaÃ§Ã£o
function ir(id){
  document.querySelectorAll('.tela').forEach(t=>t.classList.remove('ativa'));
  document.getElementById(id).classList.add('ativa');
}

// senha
function definirSenha(){
  const s=document.getElementById('senhaCriada').value;
  if(!s){alert('Crie uma senha');return;}
  localStorage.setItem('senhaCartinha',s);
  ir('menu');
}

// salvar dados
function salvarTudo(){
  const dados={
    titulo:titulo.value,
    texto:texto.value,
    data:dataInicio.value
  };
  localStorage.setItem('dadosCartinha',JSON.stringify(dados));
  alert('Salvo com sucesso â¤ï¸');
}

// fotos
let fotos=[];
let musica=null;

fotosInput.onchange=()=>{
  [...fotosInput.files].forEach(f=>{
    const r=new FileReader();
    r.onload=e=>{fotos.push(e.target.result); salvarFotos();}
    r.readAsDataURL(f);
  })
}

function salvarFotos(){
  localStorage.setItem('fotos',JSON.stringify(fotos));
}

musicaInput.onchange=()=>{
  const f=musicaInput.files[0];
  if(!f) return;
  const r=new FileReader();
  r.onload=e=>{
    localStorage.setItem('musica',e.target.result);
  }
  r.readAsDataURL(f);
}

// carregar preview
function carregarPreview(){
  const d=JSON.parse(localStorage.getItem('dadosCartinha')||'{}');
  const fotosSalvas=JSON.parse(localStorage.getItem('fotos')||'[]');
  const musicaSalva=localStorage.getItem('musica');

  pTitulo.innerText=d.titulo||'';
  pTexto.innerText=d.texto||'';

  pFotos.innerHTML='';
  fotosSalvas.forEach(f=>{
    const img=document.createElement('img');
    img.src=f;
    pFotos.appendChild(img);
  });

  if(musicaSalva){ audio.src=musicaSalva; }

  if(d.data){
    setInterval(()=>{
      const diff=new Date()-new Date(d.data);
      const dias=Math.floor(diff/86400000);
      const h=Math.floor(diff/3600000)%24;
      const m=Math.floor(diff/60000)%60;
      const s=Math.floor(diff/1000)%60;
      tempo.innerText=`${dias} dias, ${h}h ${m}m ${s}s juntos ğŸ’`;
    },1000);
  }
}

// link e QR
function gerarLink(){
  const url=window.location.href;
  linkFinal.value=url;

  const qr=document.getElementById('qr');
  qr.innerHTML='';
  const img=document.createElement('img');
  img.src=`https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(url)}`;
  qr.appendChild(img);
}

function copiarLink(){
  linkFinal.select();
  document.execCommand('copy');
  alert('Link copiado â¤ï¸');
}

// sempre que entrar nessas telas
setInterval(()=>{
  if(document.getElementById('preview').classList.contains('ativa')) carregarPreview();
  if(document.getElementById('link').classList.contains('ativa')) gerarLink();
},800);

// coraÃ§Ãµes
setInterval(()=>{
  const h=document.createElement('div');
  h.className='heart';
  h.innerText='â¤';
  h.style.left=Math.random()*100+'vw';
  h.style.fontSize=(14+Math.random()*20)+'px';
  document.body.appendChild(h);
  setTimeout(()=>h.remove(),6000);
},900);
</script>

</body>
</html>
